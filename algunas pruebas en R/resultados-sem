> library(sem)
library(sem)
> data(Klein)
data(Klein)
> Klein
Klein
   Year    C    P   Wp    I K.lag    X  Wg    G    T
1  1920 39.8 12.7 28.8  2.7 180.1 44.9 2.2  2.4  3.4
2  1921 41.9 12.4 25.5 -0.2 182.8 45.6 2.7  3.9  7.7
3  1922 45.0 16.9 29.3  1.9 182.6 50.1 2.9  3.2  3.9
4  1923 49.2 18.4 34.1  5.2 184.5 57.2 2.9  2.8  4.7
5  1924 50.6 19.4 33.9  3.0 189.7 57.1 3.1  3.5  3.8
6  1925 52.6 20.1 35.4  5.1 192.7 61.0 3.2  3.3  5.5
7  1926 55.1 19.6 37.4  5.6 197.8 64.0 3.3  3.3  7.0
8  1927 56.2 19.8 37.9  4.2 203.4 64.4 3.6  4.0  6.7
9  1928 57.3 21.1 39.2  3.0 207.6 64.5 3.7  4.2  4.2
10 1929 57.8 21.7 41.3  5.1 210.6 67.0 4.0  4.1  4.0
11 1930 55.0 15.6 37.9  1.0 215.7 61.2 4.2  5.2  7.7
12 1931 50.9 11.4 34.5 -3.4 216.7 53.4 4.8  5.9  7.5
13 1932 45.6  7.0 29.0 -6.2 213.3 44.3 5.3  4.9  8.3
14 1933 46.5 11.2 28.5 -5.1 207.1 45.1 5.6  3.7  5.4
15 1934 48.7 12.3 30.6 -3.0 202.0 49.7 6.0  4.0  6.8
16 1935 51.3 14.0 33.2 -1.3 199.0 54.4 6.1  4.4  7.2
17 1936 57.7 17.6 36.8  2.1 197.7 62.7 7.4  2.9  8.3
18 1937 58.7 17.3 41.0  2.0 199.8 65.0 6.7  4.3  6.7
19 1938 57.5 15.3 38.2 -1.9 201.8 60.9 7.7  5.3  7.4
20 1939 61.6 19.0 41.6  1.3 199.9 69.5 7.8  6.6  8.9
21 1940 65.0 21.1 45.0  3.3 201.2 75.7 8.0  7.4  9.6
22 1941 69.7 23.5 53.3  4.9 204.5 88.4 8.5 13.8 11.6
> Klein$P.lag <- c(NA, Klein$P[-22])
Klein$P.lag <- c(NA, Klein$P[-22])
> Klein$X.lag <- c(NA, Klein$X[-22])
Klein$X.lag <- c(NA, Klein$X[-22])
> Klein[1:3,]
Klein[1:3,]
  Year    C    P   Wp    I K.lag    X  Wg   G   T P.lag X.lag
1 1920 39.8 12.7 28.8  2.7 180.1 44.9 2.2 2.4 3.4    NA    NA
2 1921 41.9 12.4 25.5 -0.2 182.8 45.6 2.7 3.9 7.7  12.7  44.9
3 1922 45.0 16.9 29.3  1.9 182.6 50.1 2.9 3.2 3.9  12.4  45.6
> Klein.eqn1 <- tsls(C ~ P + P.lag + I(Wp + Wg),
Klein.eqn1 <- tsls(C ~ P + P.lag + I(Wp + Wg),
+ 		instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
+ 		data=Klein)
data=Klein)
> Klein.eqn2 <- tsls(I ~ P + P.lag + K.lag,
Klein.eqn2 <- tsls(I ~ P + P.lag + K.lag,
+ 		instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
+ 		data=Klein)
data=Klein)
> Klein.eqn3 <- tsls(Wp ~ X + X.lag + I(Year - 1931),
Klein.eqn3 <- tsls(Wp ~ X + X.lag + I(Year - 1931),
+ 		instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
instruments=~ G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag,
+ 		data=Klein)
data=Klein)
> summary(Klein.eqn1)
summary(Klein.eqn1)

 2SLS Estimates

Model Formula: C ~ P + P.lag + I(Wp + Wg)

Instruments: ~G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-1.8930 -0.6163 -0.2459  0.0000  0.8854  2.0030 

               Estimate  Std. Error  t value   Pr(>|t|)    
(Intercept) 16.55475577  1.46797870 11.27725 2.5869e-09 ***
P            0.01730221  0.13120458  0.13187   0.896634    
P.lag        0.21623404  0.11922168  1.81371   0.087413 .  
I(Wp + Wg)   0.81018270  0.04473506 18.11069 1.5050e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.1356586 on 17 degrees of freedom

> summary(Klein.eqn2)
summary(Klein.eqn2)

 2SLS Estimates

Model Formula: I ~ P + P.lag + K.lag

Instruments: ~G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-3.2910 -0.8069  0.1423  0.0000  0.8601  1.7960 

               Estimate  Std. Error  t value  Pr(>|t|)   
(Intercept) 20.27820896  8.38324891  2.41890 0.0270705 * 
P            0.15022182  0.19253359  0.78024 0.4459798   
P.lag        0.61594358  0.18092585  3.40440 0.0033755 **
K.lag       -0.15778764  0.04015207 -3.92975 0.0010797 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.3071491 on 17 degrees of freedom

> summary(Klein.eqn3)
summary(Klein.eqn3)

 2SLS Estimates

Model Formula: Wp ~ X + X.lag + I(Year - 1931)

Instruments: ~G + T + Wg + I(Year - 1931) + K.lag + P.lag + X.lag

Residuals:
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
-1.2940 -0.4734  0.0145  0.0000  0.4487  1.1960 

                 Estimate Std. Error  t value   Pr(>|t|)    
(Intercept)    1.50029689 1.27568637  1.17607 0.25577411    
X              0.43885907 0.03960266 11.08155 3.3679e-09 ***
X.lag          0.14667382 0.04316395  3.39806 0.00342209 ** 
I(Year - 1931) 0.13039569 0.03238839  4.02600 0.00087642 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.7671553 on 17 degrees of freedom

> sqrt(diag(vcov(Klein.eqn1)*17/21))
sqrt(diag(vcov(Klein.eqn1)*17/21))
(Intercept)           P       P.lag  I(Wp + Wg) 
 1.32079242  0.11804941  0.10726796  0.04024971 
> sqrt(diag(vcov(Klein.eqn2)*17/21))
sqrt(diag(vcov(Klein.eqn2)*17/21))
(Intercept)           P       P.lag       K.lag 
 7.54270590  0.17322929  0.16278539  0.03612624 
> sqrt(diag(vcov(Klein.eqn3)*17/21))
sqrt(diag(vcov(Klein.eqn3)*17/21))
   (Intercept)              X          X.lag I(Year - 1931) 
    1.14778020     0.03563192     0.03883613     0.02914098 